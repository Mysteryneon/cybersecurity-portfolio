#!/usr/bin/env python3

# Usage:
#   python3 tech_stack_fingerprint.py <url>
#   python3 tech_stack_fingerprint.py -h

import sys
import subprocess

def usage():
    print("Usage: python3 tech_stack_fingerprint.py <url>")
    print("Example: python3 tech_stack_fingerprint.py https://example.com")
    sys.exit(0)

if len(sys.argv) != 2 or sys.argv[1] in ("-h", "--help"):
    usage()

url = sys.argv[1]
try:
    output = subprocess.check_output(["curl", "-I", "-s", url], stderr=subprocess.DEVNULL).decode()
    print("[*] Response Headers:\n")
    print(output)

    indicators = {
        "server": ["nginx", "apache", "cloudflare"],
        "x-powered-by": ["php", "express", "asp.net"],
        "via": ["varnish", "akamai", "fastly"]
    }

    print("[*] Possible Technologies:")
    for line in output.lower().splitlines():
        for key, values in indicators.items():
            if key in line:
                for val in values:
                    if val in line:
                        print(f"[+] Detected: {val.title()} from '{line.strip()}'")
except Exception as e:
    print(f"[!] Error: {e}")
