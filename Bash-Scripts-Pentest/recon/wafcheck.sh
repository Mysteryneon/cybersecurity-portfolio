#!/bin/bash

usage() {
  echo "Usage: $0 <url>"
  echo "Example: $0 https://target.com"
  exit 0
}

if [[ "$1" == "-h" || "$1" == "--help" ]]; then
  usage
fi

if [ -z "$1" ]; then
  usage
fi

URL="$1"

echo "[*] Checking WAF headers for $URL..."
curl -s -I "$URL" -o /tmp/waf_headers.txt

cat /tmp/waf_headers.txt | grep -iE 'cloudflare|akamai|imperva|sucuri|f5|barracuda|360wzws' && \
  echo "[+] WAF Detected!" || \
  echo "[-] No WAF headers found."
