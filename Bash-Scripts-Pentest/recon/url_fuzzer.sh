#!/bin/bash
# url_param_fuzzer.sh - Fuzz common GET parameters for possible issues
#
# Usage:
#   ./url_param_fuzzer.sh <base_url_with_EQUAL_SIGN>
#   ./url_param_fuzzer.sh -h
#
# Example:
#   ./url_param_fuzzer.sh 'https://example.com/index.php?page='

usage() {
  echo "Usage: $0 <base_url_with_EQUAL_SIGN>"
  echo "Example: $0 'https://example.com/index.php?page='"
  echo "This fuzzes the value after the '=' with payloads like ../, <script>, etc."
  exit 0
}

if [[ "$1" == "-h" || "$1" == "--help" || -z "$1" ]]; then
  usage
fi

BASE_URL="$1"
PAYLOADS=("../../etc/passwd" "<script>alert(1)</script>" "' OR '1'='1" "%2e%2e%2f")

echo "[*] Fuzzing: $BASE_URL"
for payload in "${PAYLOADS[@]}"; do
  echo -n "[+] Testing: $payload ... "
  curl -s -o /dev/null -w "%{http_code}\n" "${BASE_URL}${payload}"
done
