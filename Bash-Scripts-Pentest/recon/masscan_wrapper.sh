#!/bin/bash
# masscan_wrapper.sh - Fast port scanning using masscan with safe options
#
# Usage:
#   ./masscan_wrapper.sh <target_ip_or_range> [interface]
#   ./masscan_wrapper.sh -h
#
# Example:
#   ./masscan_wrapper.sh 192.168.1.0/24 eth0

usage() {
  echo "Usage: $0 <target_ip_or_range> [interface]"
  echo "Example: $0 192.168.1.0/24 eth0"
  exit 0
}

if [[ "$1" == "-h" || "$1" == "--help" || -z "$1" ]]; then
  usage
fi

TARGET="$1"
IFACE="${2:-eth0}"

echo "[*] Running masscan on $TARGET via $IFACE..."
sudo masscan -e "$IFACE" -p1-65535 "$TARGET" --rate=1000 --wait=0
