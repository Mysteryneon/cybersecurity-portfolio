#!/usr/bin/env python3

import sys
import requests

def usage():
    print("Usage: python3 waf_fingerprint.py <url>")
    print("Example: python3 waf_fingerprint.py https://target.com")
    sys.exit(0)

if len(sys.argv) != 2 or sys.argv[1] in ("-h", "--help"):
    usage()

url = sys.argv[1]

try:
    r = requests.get(url, timeout=10)
    print("[*] Response headers:")
    for k, v in r.headers.items():
        print(f"{k}: {v}")

    wafs = {
        "cloudflare": "cloudflare",
        "akamai": "akamai",
        "imperva": "incapsula",
        "sucuri": "sucuri",
        "barracuda": "barracuda",
        "f5": "bigip",
        "360": "wzws"
    }

    print("\n[*] Detected WAFs:")
    found = False
    for name, sig in wafs.items():
        for v in r.headers.values():
            if sig.lower() in v.lower():
                print(f"[+] {name.upper()} WAF detected")
                found = True
    if not found:
        print("[-] No known WAF signatures detected.")

except Exception as e:
    print(f"[!] Request failed: {e}")
