#!/usr/bin/env python3
# simple_hash_id.py - Identify common hash types
#
# Usage:
#   python3 simple_hash_id.py <hash>
#   python3 simple_hash_id.py -h

import sys
import re

def usage():
    print("Usage: python3 simple_hash_id.py <hash>")
    sys.exit(0)

if len(sys.argv) != 2 or sys.argv[1] in ("-h", "--help"):
    usage()

hash_input = sys.argv[1]
length = len(hash_input)

patterns = {
    "MD5": r"^[a-f0-9]{32}$",
    "SHA1": r"^[a-f0-9]{40}$",
    "SHA256": r"^[a-f0-9]{64}$",
    "bcrypt": r"^\$2[aby]?\$\d{2}\$[./A-Za-z0-9]{53}$",
    "NTLM": r"^[A-Fa-f0-9]{32}$"
}

for name, pattern in patterns.items():
    if re.fullmatch(pattern, hash_input):
        print(f"[+] Possible match: {name}")
        break
else:
    print("[-] Unknown hash format.")
